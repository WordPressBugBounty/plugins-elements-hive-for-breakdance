(function(i,e){typeof exports=="object"&&typeof module<"u"?module.exports=e():typeof define=="function"&&define.amd?define(e):(i=typeof globalThis<"u"?globalThis:i||self,i.EhInkCursor=e())})(this,function(){"use strict";class i{constructor(t){this.index=t.index,this.container=t.container,this.sizeFactor=t.sizeFactor,this.width=t.width,this.sine=t.sine,this.angleSpeed=t.angleSpeed,this.x=0,this.y=0,this.scale=this.sizeFactor-.05*this.sizeFactor*this.index,this.range=this.width/4*this.scale/this.sizeFactor,this.limit=this.width*.75*this.scale,this.element=document.createElement("span"),this.element.style.transform=`scale(${this.scale})`,this.container.append(this.element)}lock(){this.lockX=this.x,this.lockY=this.y,this.angleX=Math.PI*2*Math.random(),this.angleY=Math.PI*2*Math.random()}draw(t){!t||this.index<=this.sine?(this.element.style.top=`${this.y}px`,this.element.style.left=`${this.x}px`):(this.angleX+=this.angleSpeed,this.angleY+=this.angleSpeed,this.y=this.lockY+Math.sin(this.angleY)*this.range,this.x=this.lockX+Math.sin(this.angleX)*this.range,this.element.style.top=`${this.y}px`,this.element.style.left=`${this.x}px`)}}class e{constructor(t){this.parent=t.parent,this.container=t.container,this.sizeFactor=t.sizeFactor,this.amount=t.amount,this.sine=t.sine/t.sizeFactor,this.idleTimeout=t.idleTimeout,this.isRelativeToPage=t.isRelativeToPage,this.angleSpeed=.05,this.width=26,this.mouse={x:0,y:0},this.lastFrame=new Date,this.dots=[],this.bounds={left:0,top:0},this.isHidden=!0,this.init()}init(){window.addEventListener("mousemove",this.onMouseMove.bind(this)),window.addEventListener("touchmove",this.onTouchMove.bind(this)),this.isRelativeToPage||(this.parent.addEventListener("pointerenter",this.onMouseEnter.bind(this)),this.parent.addEventListener("pointerleave",this.onMouseLeave.bind(this))),this.initDots(),this.render()}initDots(){for(let t=0;t<this.amount;t++){let h=new i({index:t,container:this.container,sizeFactor:this.sizeFactor,width:this.width,sine:this.sine,angleSpeed:this.angleSpeed});this.dots.push(h)}}startIdleTimer(){this.timeoutID=setTimeout(this.lockDots.bind(this),this.idleTimeout),this.idle=!1}resetIdleTimer(){clearTimeout(this.timeoutID),this.startIdleTimer()}lockDots(){this.idle=!0,this.dots.forEach(t=>{t.lock()})}onMouseMove(t){this.isRelativeToPage&&this.isHidden&&this.showCursor(),this.mouse.x=t.clientX-this.width/2,this.mouse.y=t.clientY-this.width/2,this.resetIdleTimer()}onTouchMove(t){this.isRelativeToPage&&this.isHidden&&this.showCursor(),this.mouse.x=t.touches[0].clientX-this.width/2,this.mouse.y=t.touches[0].clientY-this.width/2,this.resetIdleTimer()}onMouseEnter(){this.showCursor()}onMouseLeave(){this.hideCursor()}hideCursor(){this.container.style.visibility="hidden",this.isHidden=!0}showCursor(){this.container.style.visibility="initial",this.isHidden=!1}render(t){this.delta=t-this.lastFrame,this.positionCursor(),this.lastFrame=t,requestAnimationFrame(this.render.bind(this))}positionCursor(){let t=this.mouse.x,h=this.mouse.y;this.dots.forEach((s,n,o)=>{let a=o[n+1]||o[0];if(s.x=t,s.y=h,s.draw(this.idle),!this.idle||n<=this.sine){const d=(a.x-s.x)*.35,r=(a.y-s.y)*.35;t+=d,h+=r}})}}return e});
